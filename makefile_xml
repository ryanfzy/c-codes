OBJDIR = obj
BINDIR = bin
OBJECTS = $(OBJDIR)/test_xml.o $(OBJDIR)/xml.o $(OBJDIR)/structs.o $(OBJDIR)/stack.o

CHECK_LIB = -LC:\check-0.15.2.tar\check-0.15.2\src\.libs -lcheck
CHECK_INC = -I C:\check-0.15.2.tar\check-0.15.2 -IC:\check-0.15.2.tar\check-0.15.2\src

STD_OPTS = -Wall -std=c99 -Iinclude -c $< -o $@

$(BINDIR)/test_xml.exe : $(OBJECTS) | $(BINDIR)
	gcc -Wall -o $@ $(OBJECTS) $(CHECK_LIB)
$(OBJDIR)/xml.o : xml/xml.c
	gcc $(STD_OPTS)
$(OBJDIR)/structs.o : containers/structs.c
	gcc $(STD_OPTS)
$(OBJDIR)/stack.o : containers/stack.c
	gcc $(STD_OPTS)
$(OBJDIR)/test_xml.o : tests/test_xml.c xml/xml.h
	gcc $(CHECK_INC) $(STD_OPTS)

$(OBJECTS): | $(OBJDIR)
$(OBJDIR):
	mkdir $(OBJDIR)

$(BINDIR):
	mkdir $(BINDIR)